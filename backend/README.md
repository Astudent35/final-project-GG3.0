# Midterm Project (backend)

## Database Structure
### Database Name: 
### Collection: products
```javascript
{
    _id: ObjectId,             // Id for products (generated by mongoDB)
    link: String,              // product link
    title: String,             // product title
    price: String,             // Product price
    vId: ObjectId,         // foreign key reference Id for video (generated by mongoDB)
    createdAt: Date,           // Timestamp data of created product
    updatedAt: Date,           // Timestamp data of created product
}
```
### Collection: videos
```javascript
{
    _id: ObjectId,                // Id for video (generated by mongoDB)
    url_thumbnail: String,  // Url of the image of youtube video
    url_yt: String,          // URL to youtube video
    createdAt: Date,              // timestamp data of created video
    updatedAt: Date,              // timestamp data of created video
}
```
### Collection: comments
```javascript
{
    _id: ObjectId,        //  Id for comment (generated by mongoDB)
    username: String,     // Username of the commenter
    body: String,         // user comments
    vId: ObjectId,    // foreign key reference Id for video (generated by mongoDB)
    createdAt: Date,      // Timestamp data of created comments
    updatedAt: Date,      // Timestamp data of created comments
}
```

## API Structure

### API - Tokopedia Play Clone
----
### Endpoints

- Video Thumbnail List
#### Retrieves a list of videos.

```bash
GET /video
```
#### Response
```json
[
    {
        "vId": "64bce011840cedff473d50b5",
        "url_thumbnail": "https://www.urlImg.com"
    },
    {
        "vId": "64bfd1852cfb95b52f284d47",
        "url_thumbnail": "https://www.urlImg.com"
    }
]
```

- Submit Video
##### Create a new video and return the object.

```bash
POST /video
```
#### Response
```json
{
    "success": true,
    "fail": false
}
```

- Comment List
#### Returns the specified comments with the related videoID.

```bash
GET /comment/{vId}
```
#### Response
```json
[
    {
        "username": "JohnDoe",
        "comment": "This is nice",
        "timestamp": {
            "createdAt": "2023-07-28T14:22:08.558Z",
            "updatedAt": "2023-07-28T14:22:08.558Z"
        }
    },
    {
        "username": "JohnDoe",
        "comment": "this is bad",
        "timestamp": {
            "createdAt": "2023-07-28T15:30:15.836Z",
            "updatedAt": "2023-07-28T15:30:15.836Z"
        }
    }
]
```

- Submit Comment
#### Creates a new comment and returns the object.

```bash
POST /comment
```
#### Response
```json
{
    "success": true,
    "fail": false
}
```

- Product List
#### Returns the specified products with the related videoID.

```bash
GET /product/{vId}
```
#### Response
```json
[
    {
        "productID": "64bce046840cedff473d40ad",
        "link": "https://www.linktoproduct.com",
        "title": "Jacket",
        "price": "720000"
    },
    {
        "productID": "64bfdedde98c9d8c95c1014f",
        "link": "https://www.linktoproduct.com",
        "title": "Iphone toy",
        "price": "320000"
    }
]
```
- Search Product
#### Returns the searched products with the related videoID.

```bash
GET /product/{vId}/search?title=kos
```
#### Response
```json
[
    {
        "productID": "64bce046840cedff374d04ad",
        "link": "https://www.linktoproduct.com",
        "title": "kos kaki",
        "price": "420000"
    },
    {
        "productID": "64bfd65b81bae50f63de6167",
        "link": "https://www.linktoproduct.com",
        "title": "kos demin",
        "price": "220000"
    }
]
```

- Submit Product
#### Creates a new product and returns the object.

```bash
POST /product
```
#### Response
```json
{
    "success": true,
    "fail": false
}
```

## List of API Requests and Responses

### Video Thumbnail List
* Mapped Video object
```json
{
    "vId": ObjectId,              
    "url_thumbnail": String   
}
```
**GET /video**
----
  Retrieves a list of videos.
* **URL Params**  
  None
* **Data Params**  
  None
* **Headers**  
  Content-Type: application/json  
* **Success Response:**  
* **Code:** 200  
  **Content:**  
```json
[
    {
        "vId": "64bce011840cedff473d40a9",
        "url_thumbnail": "https://www.spotify.com"
    },
    {
        "vId": "64bfd1852cfb95b52f283c46",
        "url_thumbnail": "https://www.netflix.com"
    }
]
```

### Submit Video
**POST /video**
----
  Create a new video and return the object.
* **URL Params**  
  None
* **Headers**  
  Content-Type: application/json  
* **Data Params**  
```json
{
    "url_thumbnail": "String",
    "url_yt": "String"
}
```
* **Success Response:**  
* **Code:** 200  
  **Content:**  
```json
{
    "success": true,
    "fail": false
}
``` 
* **Error Response:**  
  * **Code:** 400  
  **Content:**  
```json
{
    "success": false,
    "fail": true
}
``` 

### Comment List
* Mapped Comment object
```json
{
    "username": "String",              
    "comment": "String",
    "timestamp": {
        "createdAt": "Date",
        "updatedAt": "Date"
    }
}
```
**GET /comment/:vId**
----
  Returns the specified comments with the related videoID.
* **URL Params**  
  *Required:* `vId=[ObjectId]`
* **Data Params**  
  None
* **Headers**  
  Content-Type: application/json  
* **Success Response

:** 
* **Code:** 200  
  **Content:**  
```json
[
    {
        "username": "John",
        "comment": "This product is better than previous product",
        "timestamp": {
            "createdAt": "2023-07-28T14:18:22.558Z",
            "updatedAt": "2023-07-28T14:18:22.558Z"
        }
    },
    {
        "username": "Doe",
        "comment": "Kinda cheap for this quality def recommended",
        "timestamp": {
            "createdAt": "2023-07-28T14:22:19.836Z",
            "updatedAt": "2023-07-28T14:22:19.836Z"
        }
    }
]
```
* **Error Response:**  
  * **Code:** 400  
  **Content:**  
```json
{
    "message": "Cannot find the product based on ID"
}
```

### Submit Comment
**POST /comment**
----
  Creates a new comment and return the object.
* **URL Params**  
  None
* **Headers**  
  Content-Type: application/json  
* **Data Params**  
```json
{
    "username": "String",
    "bodyComment": "String",
    "vId": "ObjectId"
}
```
* **Success Response:**  
* **Code:** 200  
  **Content:**  
```json
{
    "success": true,
    "fail": false
}
``` 
* **Error Response:**  
  * **Code:** 400  
  **Content:**  
```json
{
    "success": false,
    "fail": true
}
``` 

### Product List
* Mapped Product object
```json
{
    "productID": "ObjectID",
    "link": "String",
    "title": "String",
    "price": "String"
}
```
**GET /product/:vId**
----
  Returns the specified products with the related videoID.
* **URL Params**  
  *Required:* `vId=[ObjectId]`
* **Data Params**  
  None
* **Headers**  
  Content-Type: application/json  
* **Success Response:** 
* **Code:** 200  
  **Content:**  
```json
[
    {
        "productID": "64bce046840cedff473d40ad",
        "link": "https://www.linktoproduct.com",
        "title": "Jacket",
        "price": "2220000"
    },
    {
        "productID": "64bfdedde98c9d8c95c1014f",
        "link": "https://www.linktoproduct.com",
        "title": "Football",
        "price": "440000"
    }
]
```
* **Error Response:**  
  * **Code:** 400  
  **Content:**  
```json
{
    "message": "cannot find the item"
}
```

### Search Product
* Mapped Product object
```json
{
    "productID": "ObjectID",
    "link": "String",
    "title": "String",
    "price": "String"
}
```
**GET /product/:vId/search?title=**
----
  Returns the searched products with the related videoID.
* **URL Params**  
  *Required:* `vId=[ObjectId]`
  *Required:* `title=[String]`
* **Data Params**  
  None
* **Headers**  
  Content-Type: application/json  
* **Success Response:** 
* **Code:** 200  
  **Content:**  
```json
[
    {
        "productID": "64bce046084cedff473d40ad",
        "link": "https://www.linktoproduct.com",
        "title": "Car",
        "price": "20000"
    },
    {
        "productID": "64bfd65b81bae50f36de6126",
        "link": "https://www.linktoproduct.com",
        "title": "Socks",
        "price": "20000"
    }
]
```
* **Error Response:**  
  * **Code:** 400  
  **Content:**  
```json
{
    "message": "cannot find the product"
}
```

### Submit Product
**POST /product**
----
  Creates a new product and return the object.
* **URL Params**  
  None
* **Headers**  
  Content-Type: application/json  
* **Data Params**  
```json
{
    "link": "String",
    "title": "String",
    "price": "String",
    "vId": "ObjectId"
}
```
* **Success Response:**  
* **Code:** 200  
  **Content:**  
```json
{
    "success": true,
    "fail": false
}
``` 
* **Error Response:**  
  * **Code:** 400  
  **Content:**  
```json
{
    "success": false,
    "fail": true
}
``` 
    
## How to Run

1. Clone this repo

2. Install all of the important packages by running the command below, make sure you are in the correct directory
```bash
npm install
```
3. Make sure to duplicate the .env.example file and rename it .env and change the content accordingly

4. Run the project using this command
```bash
yarn dev
```
5. In order to create and access all collections, hit (run) all the POST Method API to initialize data. Use this order:
   - POST /video (first)
   - POST /comment (second)
   - POST /product (third)

Please make sure to replace any placeholders such as `<mapped_video_object>` and `<mapped_comment_object>` with the actual structures or examples of the objects. Also, update the API responses with actual data if available.